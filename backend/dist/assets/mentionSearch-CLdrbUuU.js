import{s as h,a as N,c as l}from"./index-B9bzJ0i3.js";const E=async({worldId:i,query:m,limit:d=4,callback:s})=>{const o=m?.trim()??"";if(typeof s=="function"){if(!i||o.length===0){s([]);return}try{const[r,a]=await Promise.all([h({worldId:i,query:o,limit:d}).catch(()=>({data:[]})),N({worldId:i,query:o,limit:d}).catch(t=>(console.error("Failed to search locations for mention search",t),{data:[]}))]),f=Array.isArray(r?.data)?r.data:Array.isArray(r)?r:[];let n=[];a&&(a?.success&&Array.isArray(a?.data)||Array.isArray(a?.data)?n=a.data:Array.isArray(a)&&(n=a));const u=f.map(t=>{const e=t?.id??t?.entity?.id;if(!e)return null;const c=t?.name||t?.displayName||t?.entity?.name||"Unnamed entity",y=l(c)||"Unnamed entity";return{id:`entity:${e}`,display:y,type:"entity"}}).filter(Boolean),p=(Array.isArray(n)?n:[]).map(t=>{if(!t||typeof t!="object")return null;const e=t?.id;if(!e)return null;const c=String(t?.name||"").trim()||"Unnamed location",y=l(c)||"Unnamed location";return{id:`location:${e}`,display:y,type:"location"}}).filter(Boolean),A=[...u,...p].sort((t,e)=>t.display.localeCompare(e.display));s(A)}catch(r){console.error("Failed to search mentions",r),s([])}}};export{E as default,E as searchMentions};
